<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy Raksha Bandhan!</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="greeting-container">
    <h1>Happy Raksha Bandhan, <span id="receiverName"></span>! 🎉</h1>
    <p>May this thread of love always keep us connected. 🪢</p>
    <button onclick="window.location.href='sister.html'">💌 Read My Message</button>
    <button onclick="shareOnWhatsApp()">📤 Share on WhatsApp</button>
    <button onclick="goHome()">🎁 Send Another Wish</button>
  </div>

  <!-- ✅ Music controls -->
  <audio id="bgMusic" loop>
    <source src="rakhi.mp3" type="audio/mpeg">
  </audio>
  <button id="musicBtn" onclick="toggleMusic()">🎵 Play Music</button>

  <script>
    // Extract name from URL
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get('name') || "Dear";
    document.getElementById("receiverName").textContent = name;

    function shareOnWhatsApp() {
      const link = window.location.href;
      const message = `🌼 Happy Raksha Bandhan! A wish just for you: ${link}`;
      window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
    }

    function goHome() {
      window.location.href = "index.html";
    }

    // Confetti Effect
    for (let i = 0; i < 30; i++) {
      let confetti = document.createElement("div");
      confetti.className = "confetti";
      confetti.style.left = Math.random() * 100 + "vw";
      confetti.style.animationDelay = Math.random() * 2 + "s";
      document.body.appendChild(confetti);
    }

    // ✅ Music toggle logic
    const audio = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");

    // Resume music if it was already playing
    if (sessionStorage.getItem("music") === "playing") {
      audio.play().catch(() => {
        // Autoplay blocked (common on Android)
        console.log("Autoplay blocked, waiting for user interaction");
      });
      musicBtn.textContent = "🔇 Pause Music";
    }

    function toggleMusic() {
      if (audio.paused) {
        audio.play();
        sessionStorage.setItem("music", "playing");
        musicBtn.textContent = "🔇 Pause Music";
      } else {
        audio.pause();
        sessionStorage.setItem("music", "paused");
        musicBtn.textContent = "🎵 Play Music";
      }
    }

    // ✅ Extra Fix for Android (tap anywhere to resume if blocked)
    document.body.addEventListener('click', () => {
      if (sessionStorage.getItem("music") === "playing" && audio.paused) {
        audio.play().catch(err => console.log("Play failed:", err));
        musicBtn.textContent = "🔇 Pause Music";
      }
    });
  </script>
</body>

</html>